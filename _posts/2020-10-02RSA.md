---
layout: post
title: RSA
date: 2020-10-02
author: Brad
tags:  Unclassified
comments: true
toc: true
pinned: false
---

* RSA, Rivest & Shamir & Adleman
* 非對稱
* 利用兩個質數作為加密解密的兩個鑰匙，長度在 40 ~ 2048 bits (RSA-640, RSA-704, RSA-768, RSA-896, RSA-1024, RSA-1536, RSA-2048)
	* public key
	* private/secret key
> 互質關係, coprime

<!-- more -->

## 歐拉函數及定理

* 對正整數 n ，小於等於 n 的正整數中與 n 互質的總數
	* ϕ(8)=4;  1, 3, 5, 7  和 8 互質
* 假設為 7 bits ，則可容納十進範圍為0~127
	* 目前2048 bits ，容納範圍 0~2^2048
* 情況
	1. n=1, 則 ϕ(1)=1  ， 1 與任何數(包含自己)都構成互質
	2. n 是質數，則 ϕ(n)=n−1。 因為質數與小於它的每個數都構成互質關係
	3. 如果 n 是質數的某一個次方，即 $n=p^k$  (p為質數，k ≥ 1的整數) ，則 $\Phi(p^k)=p^k-p^{k-1}$ 可寫成 $\Phi(p^k )=p^k−p^{k−1}=p^k(1−\frac{1}{p})$
        1. $\Phi(8)=\Phi(2^3 )=2^3−2^2=4$
	4. 如果 $n=p_1×p_2  ，p_1 \ p_2$ 皆為質數 ，則 $\Phi(n)=\Phi(p_1×p_2 )=\Phi(p_1 )×\Phi(p_2 )$
	5. 任意一個大於1的正整數
        * n=$p_1^k1\ \ p_2^k2 ... p_r^{kr}$
        * 根據第四點可得 $\Phi(n)=\Phi(p_1^{k1})…\Phi(p_r^{kr})$
        * 根據第三點可得 $\Phi(n)=p_1^{k1}…p_r^{kr}(1−\frac{1}{p_1})…(1−\frac{1}{p_r})$
        * 最後等於 $\Phi(n)=n(1−\frac{1}{p_1})…(1−\frac{1}{p_r} )$
* 歐拉定理
	* 如果兩個正整數 a n 互質，則 n 的歐拉函數 $\Phi(n)$ 使成立： $a^\Phi(n) ≡1(mod n)$
	* a=3 和 n=7 互質，n的歐拉函數$\Phi(7)=6$ ，所以 $3^6−1=Z×n$ , Z表示被正整數的倍數
	 
## 模反元素

* 如果兩個正整數 a, n 互質，一定可以找到整數 b 
	* 模反元素 ab≡1(mod n)  (注意不是等號) 
	* 上式換算後， 可得 ab-1=Z× n   ( Z為整數倍數)
* 3 和 11 互質，3的模反元素是4，因為 (3×4)−1 可被11整除



## 例子
* 初始化隨機選擇質數，質數越大，越難破解
    *  p=61, q=53
* 計算n
    * n=p×q=3233
    * 3233換成二進制的位數n，即RSA-n
* 計算ϕ(n)
    * ϕ(n)=(p−1)×(q−1)=3120
* 隨機選擇e，條件 1<e<ϕ(n)  且 e 與 ϕ(n)互質
    * 隨機選了 e=17
    * 實際應用常選擇 65537
* 計算模反元素d
    * ed≡1 (mod ϕ(n))
    * 可換成 ed−1=kϕ(n)，其中k為k倍
    * e, ϕ(n)已知，求  17d−1=3120k⇒17d−3120k=1
    * 可求得多組解，現在找到一組解 (x,y)=(2753, -15) ，d=2753
* 公鑰=(n,e)=(3120, 17)
* 私鑰=(n,d)=(3120,2753)


## 使用
* 假設我要加密我的體重 70，公鑰=(n,e)=(3233, 17)
    * CipherText=PlainText^e   ( mod n)=70^17  mod 3233=325
* 傳送325
* 接收325，進行解密，私鑰=(n,d)=(3233,2753)
    * PlainText=CipherText^d  (mod n)=325^2753  mod 3233=70
